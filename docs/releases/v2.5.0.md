# ğŸ¨ Release v2.5.0 - Visual Countdown & History Fixes

**Released:** 2025-11-10

## ğŸ¯ Major Changes

### **1. Visual Countdown Progressbar**

Replaced the text-based countdown with a beautiful visual progressbar in the header!

**Features:**
- **Visual Progress:** See time until next run at a glance
- **Color-Coded:** 
  - ğŸŸ£ Purple (>50% remaining)
  - ğŸŸ  Orange (20-50% remaining)
  - ğŸ”´ Red (<20% remaining)
- **Live Updates:** Updates every second
- **Integrated "Run Now":** Button built into the progressbar
- **Smart Display:** Only shows when idle and repeat mode is enabled

**Example:**
```
[â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘] 67% | 20:15  [â­ï¸ Run Now]
```

---

### **2. History Display Fixed**

Fixed critical bug that prevented history from displaying!

**The Problem:**
```javascript
// JavaScript expected:
item.end_time     â†’ API sent: item.timestamp
item.success      â†’ API sent: item.status
item.archive_count â†’ API sent: item.processed_archives
```

**Result:** `new Date(undefined)` â†’ JavaScript error â†’ Empty history

**The Fix:**
- âœ… Corrected all field names
- âœ… Added error message display in timeline
- âœ… Show processed vs failed archives
- âœ… Changed to English date format

**Now You See:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ… Release.Name.2024.1080p.BluRay.x264-GROUP   â”‚
â”‚    ğŸ“… 11/9/2025, 7:30:15 PM                    â”‚
â”‚    â± 5m 23s                                    â”‚
â”‚    ğŸ“¦ Processed: 50 | Failed: 0                â”‚
â”‚    âœ“ Completed                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âŒ Failed.Archive.2024.1080p.WEB.x264-GROUP    â”‚
â”‚    ğŸ“… 11/9/2025, 7:15:42 PM                    â”‚
â”‚    â± 2m 10s                                    â”‚
â”‚    ğŸ“¦ Processed: 5 | Failed: 3                 â”‚
â”‚    âœ— Failed                                    â”‚
â”‚    âš ï¸ Errors:                                  â”‚
â”‚       â€¢ CRC failed in part03.rar               â”‚
â”‚       â€¢ Unexpected end of archive              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ› Bug Fixes

| Bug | Status | Fix |
|-----|--------|-----|
| History not showing | âœ… FIXED | Corrected field names in JavaScript |
| Countdown not visual | âœ… FIXED | New progressbar UI |
| Error messages hidden | âœ… FIXED | Now shown in timeline |

---

## ğŸ“¦ Docker Deployment

```bash
docker pull ghcr.io/rokk001/cineripr:2.5.0
docker pull ghcr.io/rokk001/cineripr:latest
```

**docker-compose.yml:**
```yaml
services:
  cineripr:
    image: ghcr.io/rokk001/cineripr:2.5.0
    # ... rest of config
```

---

## ğŸ”„ Migration from v2.4.x

**NO BREAKING CHANGES!**

Simply pull and restart:
```bash
docker compose pull
docker compose up -d
```

**What You'll See:**
1. **New Progressbar:** In header when idle
2. **History Works:** Finally shows your processing history!
3. **Better UX:** More visual, more intuitive

---

## ğŸ¨ UI/UX Improvements

### Before (v2.4.x):
```
ğŸŒ™  â— Idle | Next: 20:15  [â­ï¸]
```

### After (v2.5.0):
```
ğŸŒ™  â— Idle  [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘] 67% | 20:15  [â­ï¸ Run Now]
```

---

## ğŸ“‹ Technical Details

### Changed Files

- **`src/cineripr/web/webgui.py`** (~200 lines changed)
  - HTML: New progressbar structure
  - CSS: `.countdown-progressbar-*` classes (80 lines)
  - JavaScript: Countdown logic rewritten (50 lines)
  - History: Field name fixes (20 lines)
  - API: New `/api/queue/preview` endpoint (stub)

- **`src/cineripr/__init__.py`**
  - Version: `2.4.3` â†’ `2.5.0`

- **`pyproject.toml`**
  - Version: `2.4.3` â†’ `2.5.0`

- **`CHANGELOG.md`**
  - Added v2.5.0 entry

### Code Highlights

**New Progressbar CSS:**
```css
.countdown-progressbar {
    position: relative;
    flex: 1;
    height: 28px;
    background: rgba(255, 255, 255, 0.05);
    border-radius: 14px;
    overflow: hidden;
}

.countdown-progressbar-fill {
    background: linear-gradient(90deg, 
        var(--accent-color) 0%, 
        rgba(139, 92, 246, 0.7) 100%
    );
    transition: width 1s linear;
}
```

**New JavaScript:**
```javascript
// Calculate percentage (inverse)
const totalSeconds = (data.repeat_interval_minutes || 30) * 60;
const remainingSeconds = data.seconds_until_next_run;
const percentage = (remainingSeconds / totalSeconds) * 100;

// Color based on time
if (percentage < 20) {
    fill.style.background = 'linear-gradient(...#ef4444...)'; // Red
} else if (percentage < 50) {
    fill.style.background = 'linear-gradient(...#f59e0b...)'; // Orange
} else {
    fill.style.background = 'linear-gradient(...purple...)';
}
```

---

## ğŸ“Š Statistics

- **Lines Changed:** ~200
- **Files Modified:** 4
- **New Features:** 2
- **Bugs Fixed:** 3
- **Development Time:** ~2 hours

---

## ğŸ”® Future Plans (v2.6.0)

Deferred to next release:
- **Queue Preview:** Show pending releases in idle mode
- **History per Release:** One entry per release (not per run)
- **Enhanced Queue:** Better visualization and filtering

These require major refactoring and will be implemented in v2.6.0.

---

## ğŸ™ User Feedback

This release addresses user reports:
- "History ist leer" â†’ âœ… FIXED
- "Countdown soll visuelle Progressbar sein" â†’ âœ… IMPLEMENTED
- "Queue ist leer" â†’ ğŸŸ¡ Partially addressed (API endpoint added)

---

## ğŸ”— Links

- **GitHub:** https://github.com/Rokk001/CineRipR
- **Docker:** https://ghcr.io/rokk001/cineripr
- **Documentation:** `docs/README.md`

