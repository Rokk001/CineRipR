# Release Notes v2.5.8

**Release Date:** 2025-11-10  
**Type:** Bug Fix & Performance Optimization

## üêõ Bug Fixes

### Progressbar Improvements

**Problem:** 
- Progressbar zeigte Prozentanzeige statt "Idle (mm:ss)"
- Farbverlauf war nicht intuitiv (rot bei wenig Zeit)
- "Run Now" Button war au√üerhalb der Progressbar

**Solution:**
- Prozentanzeige entfernt, nur noch "Idle (mm:ss)" angezeigt
- Farbverlauf: 100% = rot, 0% = gr√ºn (intuitiver)
- "Run Now" Button direkt in Progressbar integriert

### Run Now Problem Fixed

**Problem:**
- Nach Klick auf "Run Now" verschwand die Progressbar
- Queue, Logs und History wurden leer angezeigt
- Trigger wurde nicht sofort erkannt

**Solution:**
- `trigger_run_now()` l√∂scht `next_run_time` nicht mehr
- Frontend zeigt "Starting..." Zustand w√§hrend Wartezeit
- Trigger wird VOR dem Sleep gepr√ºft (sofortige Erkennung)
- Progressbar bleibt sichtbar bis Processing startet

### Disk Space Display Fixed

**Problem:**
- Disk Space wurde nicht angezeigt (0 GB / 0%)
- UNC-Pfade (z.B. `\\SERVER\Share`) funktionierten nicht

**Root Cause:**
- `Path.exists()` gibt bei UNC-Pfaden in Docker oft `False` zur√ºck
- `shutil.disk_usage()` wurde daher nie aufgerufen

**Solution:**
- `Path.exists()` Checks entfernt
- `shutil.disk_usage()` wird direkt aufgerufen
- Fehler werden abgefangen und auf 0 gesetzt
- Funktioniert jetzt auch mit UNC-Pfaden

## ‚ö° Performance Optimizations

### Smart Refresh - Nur bei √Ñnderungen

**Problem:**
- History, Queue, Logs wurden alle 2 Sekunden neu gerendert
- Sehr "nerv√∂s" und unn√∂tige DOM-Updates
- Performance-Problem bei vielen Eintr√§gen

**Solution:**
- **Change Detection:** Nur rendern wenn sich Daten ge√§ndert haben
- **History:** Nur bei neuen/ge√§nderten Eintr√§gen
- **Queue:** Nur bei √Ñnderungen
- **Logs:** Nur bei neuen Logs
- **System Health:** Nur bei √Ñnderungen
- **Status/Progressbar:** Nur bei √Ñnderungen
- **Current Operation:** Nur bei √Ñnderungen
- **Next Run Countdown:** Nur bei √Ñnderungen

**Impact:**
- Deutlich weniger DOM-Updates
- Fl√ºssigere UI
- Bessere Performance
- Keine "nerv√∂sen" Refreshes mehr

## üîß Technical Details

### JavaScript Optimizations

- **Helper Functions:**
  - `arraysEqual()` f√ºr Array-Vergleiche
  - `objectsEqual()` f√ºr Object-Vergleiche

- **Change Detection:**
  - Vergleich mit `previousStatus` vor jedem Render
  - JSON.stringify f√ºr einfache Vergleiche
  - Nur bei tats√§chlichen √Ñnderungen DOM-Updates

- **Progressbar:**
  - Farbverlauf: Rot (#dc2626) ‚Üí Gr√ºn (#10b981)
  - Interpolation basierend auf verbleibender Zeit
  - "Run Now" Button in Progressbar integriert

### Backend Fixes

- **`status.py`:**
  - `update_system_health()`: Direkter `disk_usage()` Aufruf
  - Fehlerbehandlung mit Fallback auf 0
  - UNC-Pfade werden jetzt korrekt unterst√ºtzt

- **`status.py`:**
  - `trigger_run_now()`: L√∂scht `next_run_time` nicht mehr
  - Frontend kann "Starting..." Zustand anzeigen

- **`cli.py`:**
  - Trigger wird VOR dem Sleep gepr√ºft
  - Sofortige Erkennung von "Run Now"

## üì¶ Migration

No migration required. This is a bug fix and performance optimization that works with existing configurations.

## üöÄ Upgrade Instructions

1. Pull the latest Docker image: `docker pull ghcr.io/rokk001/cineripr:latest`
2. Restart your container
3. All fixes and optimizations are active immediately

---

**Full Changelog:** [v2.5.7...v2.5.8](https://github.com/Rokk001/CineRipR/compare/v2.5.7...v2.5.8)

